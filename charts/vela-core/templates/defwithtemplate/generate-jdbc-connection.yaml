# Code generated by KubeVela templates. DO NOT EDIT. Please edit the original cue file.
# Definition source cue file: vela-templates/definitions/internal/read-object.cue
apiVersion: core.oam.dev/v1beta1
kind: WorkflowStepDefinition
metadata:
  annotations:
    definition.oam.dev/description: Read objects for your workflow steps
  labels:
    custom.definition.oam.dev/ui-hidden: "true"
  name: generate-jdbc-connection
  namespace: vela-system
spec:
  schematic:
    cue:
      template: |
        import (
        	"vela/op"
        	"encoding/base64"
        )

        "generate-jdbc-connection": {
        	type: "workflow-step"
        	annotations: {}
        	labels: {
        		"ui-hidden": "true"
        	}
        	description: "Generate a JDBC connection based on Component of alibaba-rds"
        }
        template: {
        		output: op.#Read & {
        			value: {
        				apiVersion: "v1"
        				kind:       "Secret"
        				metadata: {
        					name: parameter.name
        					if parameter.namespace != _|_ {
        						namespace: parameter.namespace
        					}
        				}
        			}
        		}

        		cluster: parameter.cluster
        		dbHost:  op.#ConvertString & {bt: base64.Decode(null, output.value.data["DB_HOST"])}
        		jdbc:    dbHost

        	parameter: {
        		// +usage=Specify the name of the secret generated by alibaba-rds
        		name: string
        		// +usage=Specify the namespace of the secret generated by alibaba-rds
        		namespace?: string
        		// +usage=Specify the cluster of the object
        		cluster: *"" | string
        	}
        }
